{% extends "layouts/base.html" %}

{% block title %} Studio {% endblock %}

<!-- Specific Page CSS goes HERE  -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

<main>

<!--            {% include 'includes/preloader.html' %}-->

    <!-- Hero -->
    <section class="section-header bg-secondary">
        <div class="container">
            <div class="row justify-content-between d-flex align-items-start">
                <div class="col-12 col-md-5 col-lg-4 text-center text-md-left sticky-md-top">
                    <div class="card border-0 p-2 p-md-3 p-lg-4 mb-3">
                        <div class="card-header bg-cream border-0 text-center">
                            <h3>Get inspired!</h3>
                            <p>Select the preferences for your project:</p>
                        </div>
                        <div class="card-body pt-0">
                            <form class="needs-validation" enctype="multipart/form-data"
                                  action="{{ url_for('studio_blueprint.generate_image', variation_image='none', var=0) }}" method="POST" novalidate>
                                <!-- Form -->
                                <div class="mb-4 input-group">
                                    <div class="custom-file">
                                    <label class="custom-file-label" for="baseimage">Select base image:</label>
                                    <input type="file" class="custom-file-input form-control" id="baseimage" name="inimage" aria-describedby="inputGroupFileAddon01" required>
                                    </div>
                                    <div class="form-check form-switch">
                                        <input class="form-check-input" type="checkbox" id="flexSwitchCheckDefault"
                                               name="scratch">
                                        <label class="form-check-label" for="flexSwitchCheckDefault">Or start from
                                            scratch</label>
                                    </div>
                                </div>
                                <!-- End of Form -->
                                <!-- Form -->
                                <div class="mb-4">
                                    <select class="form-select form-select-sm" name="style" aria-label="Style select"
                                            required>
                                        <option selected disabled value="">Choose style...</option>
                                        {% for style in styles: %}
                                        <option value="{{ style[0] }}">{{ style[1] }}</option>
                                        {% endfor %}
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a style.
                                    </div>
                                </div>
                                <!-- End of Form -->
                                <!-- Form -->
                                <div class="mb-4">
                                    <select class="form-select form-select-sm" name="color_mood"
                                            aria-label="Color feel select" required>
                                        <option selected disabled value="">Choose color mood...</option>
                                        {% for mood in moods: %}
                                        <option value="{{ mood[0] }}">{{ mood[1] }}</option>
                                        {% endfor %}
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a color mood.
                                    </div>
                                </div>
                                <!-- End of Form -->
                                <!-- Form -->
                                <div class="mb-4">
                                    <select class="form-select form-select-sm" name="room"
                                            aria-label="Type of room select" required>
                                        <option selected disabled value="">Choose type of room...</option>
                                        {% for room in rooms: %}
                                        <option value="{{ room[0] }}">{{ room[1] }}</option>
                                        {% endfor %}
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select a type of room.
                                    </div>
                                </div>
                                <!-- End of Form -->
                                <!-- Form -->
                                <div class="mb-4 row">
                                    <label for="samplesRange" class="form-label">Number of samples</label>
                                    <div class="col-sm-9">
                                        <input type="range" class="form-range" name="amountRange" min="1" max="4"
                                               value="1" step="1" id="samplesRange"
                                               oninput="this.form.amountInput.value=this.value">
                                    </div>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control form-control-sm" value="1"
                                               name="amountInput" disabled readonly>
                                    </div>
                                </div>
                                <!-- End of Form -->
                                <!-- Form -->
                                <div class="mb-4">
                                    <select class="form-select form-select-sm" id="aspectRatio" name="ratio"
                                            aria-label="Aspect ratio of the image" disabled required>
                                        <option selected disabled value="">Choose image aspect ratio...</option>
                                        <option value="1" >4:3</option>
                                        <option value="2" >3:4</option>
                                        <option value="3" >1:1</option>
<!--                                        <option value="4" >16:9</option>-->
<!--                                        <option value="5" >9:16</option>-->
                                    </select>
                                    <div class="invalid-feedback">
                                        Please select aspect ratio.
                                    </div>
                                </div>
                                <!-- End of Form -->
                                <!-- Form -->
<!--                                <div class="mb-4 row">-->
<!--                                    <label for="customWidth" class="form-label">Width <span class="fas fa-info-circle"-->
<!--                                                                                            title="Select 'start from scratch' to change dimensions."></span></label>-->
<!--                                    <div class="col-sm-8">-->
<!--                                        <input type="range" class="form-range" name="widthRange" min="512" max="1024"-->
<!--                                               value="512" step="64" id="customRange4"-->
<!--                                               oninput="this.form.widthInput.value=this.value" disabled>-->
<!--                                    </div>-->
<!--                                    <div class="col-sm-4">-->
<!--                                        <input type="text" class="form-control form-control-sm" value="512"-->
<!--                                               name="widthInput" id="customWidth" readonly>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                                &lt;!&ndash; End of Form &ndash;&gt;-->
<!--                                &lt;!&ndash; Form &ndash;&gt;-->
<!--                                <div class="mb-4 row">-->
<!--                                    <label for="customHeight" class="form-label">Height <span class="fas fa-info-circle"-->
<!--                                                                                              title="Select 'start from scratch' to change dimensions."></span></label>-->
<!--                                    <div class="col-sm-8">-->
<!--                                        <input type="range" class="form-range" name="heightRange" min="512"-->
<!--                                               max="1024" value="512" step="64" id="customRange6"-->
<!--                                               oninput="this.form.heightInput.value=this.value" disabled>-->
<!--                                    </div>-->
<!--                                    <div class="col-sm-4">-->
<!--                                        <input type="text" class="form-control form-control-sm" value="512"-->
<!--                                               name="heightInput" id="customHeight" readonly>-->
<!--                                    </div>-->
<!--                                </div>-->
                                    <!-- End of Form -->
                                    <!-- Script to disable/enable fields when starting from scratch -->
                                    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
                                    <script>
                                        <!-- Disables / enables fields when 'start from scratch' option is selected -->
                                        $('#flexSwitchCheckDefault').on('change', function(event, state) {
                                            var status = $('#customRange4').prop('disabled');
                                            var status2 = $('#customRange6').prop('disabled');
                                            var status3 = $('#baseimage').prop('disabled');
                                            var status4 = $('#aspectRatio').prop('disabled');
                                            $('#customRange4').prop('disabled', !status);
                                            $('#customRange6').prop('disabled', !status2);
                                            $('#baseimage').prop('disabled', !status3);
                                            $('#aspectRatio').prop('disabled', !status4);
                                        });

                                    </script>

                                <div class="d-grid">
                                    <button type="submit" class="btn btn-secondary">Render</button>
                                </div>
                            </form>
                            <!-- Spinner -->
                            <script>
                                function spinner() {
                                    document.getElementsByClassName("loader")[0].style.display = "block";
                                }
                            </script>
                            <!-- End Spinner -->
                             <!-- Scroller -->
                            <script>
                            $(document).ready(function() {
                                $('#studio-results').animate({
                                    scrollTop: $('#studio-results').get(0).scrollHeight
                                }, 10);
                            });
                            </script>
                            <!-- End Scroller -->
                            <!-- Form validation -->
                            <script>
                                    (function () {
                                        'use strict'

                                        // Fetch all the forms we want to apply custom Bootstrap validation styles to
                                        var forms = document.querySelectorAll('.needs-validation')

                                        // Loop over them and prevent submission
                                        Array.prototype.slice.call(forms)
                                        .forEach(function (form) {
                                        form.addEventListener('submit', function (event) {
                                        if (!form.checkValidity()) {
                                            event.preventDefault()
                                            event.stopPropagation()
                                        }
                                            form.classList.add('was-validated')
                                            if (form.checkValidity()) {
                                            spinner()
                                            }
                                        }, false)

                                    })

                            })()
                            </script>
                            <!-- End of form validation -->
                        </div>
                    </div>
                    <!--                        <h1 class="display-2 mb-4">Full-Service <br class="d-none d-md-inline">Digital Agency</h1>-->
                    <!--                        <p class="lead mb-4 text-muted">Themesberg can help you build a modern website, a creative logo or PWA, that will bring you customers and and stay on top of your competition.</p>-->
                    <!--                        <a href="./services.html" class="btn btn-tertiary me-3 animate-up-2">What we do <span class="ms-2"><span class="fas fa-arrow-right"></span></span></a>-->
                </div>
<!-- Form section ends here -->

<!-- Results section starts here -->
                <div class="col-12 col-md-7 col-lg-8 text-center studio-col" id="studio-results">
                    <div class="loader">
                        <div class="loading">
                        </div>
                    </div>
                    {% for session in showed_images: %}
                    <div class="card border-0 p-3 p-md-3 p-lg-4 mb-3">
<!--                        <div class="row">-->
<!--                            <p>Your results: <span class="fas fa-info-circle" data-bs-container="body"-->
<!--                            data-bs-toggle="popover" data-bs-placement="right" title="Your preferences."-->
<!--                            data-bs-content="{{ details }}"></span></p>-->
<!--                        </div>-->
<!--                        <div class="border-top px-4 py-5" id="thumbnails-top-border">-->
<!--                        This row makes the card horizontally scrollable <div class="row gy-3 mb-1 pb-0 d-flex flex-row flex-nowrap scroll-thumbs"></div>-->
                        <div class="row gy-3 mb-1 pb-0">
                            {% if showed_images[session]|length == 2: %}
                            {% for image in showed_images[session]: %}
                            <div class="col-lg-6 col-md-6 col-md-6 pb-0">
                                <div class="row pt-0 pb-0">
                                <img class="gen-img thumb" src="{{ url_for('static',filename=image[1]) }}">
                                </div>
                                <div class="row pt-2 text-center pb-0">
                                    <div class="pb-0">
                                        <form class="needs-validation"
                                  action="{{ url_for('studio_blueprint.generate_image', variation_image_id=image[0], var=1) }}" method="POST" novalidate>
                                        <button type="submit" class="link-button">Variation</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% elif showed_images[session]|length == 3: %}
                            {% for image in showed_images[session]: %}
                            <div class="col-lg-4 col-md-4 col-md-6 pb-0">
                                <div class="row pt-0 pb-0">
                                <img class="gen-img thumb" src="{{ url_for('static',filename=image[1]) }}">
                                </div>
                                <div class="row pt-2 text-center pb-0">
                                    <div class="pb-0">
                                        <form class="needs-validation"
                                  action="{{ url_for('studio_blueprint.generate_image', variation_image_id=image[0], var=1) }}" method="POST" novalidate>
                                        <button type="submit" class="link-button">Variation</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% elif showed_images[session]|length > 3: %}
                            {% for image in showed_images[session]: %}
                            <div class="col-lg-3 col-md-4 col-md-6 pb-0">
                                <div class="row pt-0 pb-0">
                                <img class="gen-img thumb" src="{{ url_for('static',filename=image[1]) }}">
                                </div>
                                <div class="row pt-2 text-center pb-0">
                                    <div class="pb-0">
                                        <form class="needs-validation"
                                  action="{{ url_for('studio_blueprint.generate_image', variation_image_id=image[0], var=1) }}" method="POST" novalidate>
                                        <button type="submit" class="link-button">Variation</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% else: %}
                            {% for image in showed_images[session]: %}
                            <div class="pb-0">
                                <div class="row pt-0 pb-0">
                                <img class="gen-img thumb" src="{{ url_for('static',filename=image[1]) }}">
                                </div>
                                <div class="row pt-2 text-center pb-0">
                                    <div class="pb-0">
                                        <form class="needs-validation"
                                  action="{{ url_for('studio_blueprint.generate_image', variation_image_id=image[0], var=1) }}" method="POST" novalidate>
                                        <button type="submit" class="link-button">Variation</button>
                                        </form>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                            {% endif %}
                        </div>
<!--                        </div>-->
                    </div>
<!--                    <div class="card border-0 p-2 p-md-2 p-lg-3 mb-3">-->
<!--&lt;!&ndash;                        <div class="card-header border-0 text-center">&ndash;&gt;-->
<!--&lt;!&ndash;                            <h2>Your result:</h2>&ndash;&gt;-->
<!--&lt;!&ndash;                        </div>&ndash;&gt;-->
<!--                        <div class="row gy-3">-->
<!--&lt;!&ndash;                            {% for image in images: %}&ndash;&gt;-->
<!--&lt;!&ndash;                            {% if loop.first: %}&ndash;&gt;-->
<!--&lt;!&ndash;                            <div>&ndash;&gt;-->
<!--&lt;!&ndash;                                <div id="">&ndash;&gt;-->
<!--&lt;!&ndash;                                <img class="gen-img" src="{{url_for('static',filename=image.gen_image)}}">&ndash;&gt;-->
<!--&lt;!&ndash;                                </div>&ndash;&gt;-->
<!--&lt;!&ndash;                                <div class="row pt-2 pb-2">&ndash;&gt;-->
<!--&lt;!&ndash;                                    <div class="text-center">&ndash;&gt;-->
<!--&lt;!&ndash;                                        <button type="submit" class="btn btn-secondary btn-sm">Variation</button>&ndash;&gt;-->
<!--&lt;!&ndash;                                        <span class="fas fa-info-circle" data-bs-container="body"&ndash;&gt;-->
<!--&lt;!&ndash;                            data-bs-toggle="popover" data-bs-placement="right" title="Your preferences."&ndash;&gt;-->
<!--&lt;!&ndash;                            data-bs-content="{{ room }}, {{ style }} style, {{ mood }} color accents. Aspect ratio {{ aspect_ratio }}. - Click again to dismiss -"></span>&ndash;&gt;-->
<!--&lt;!&ndash;                                    </div>&ndash;&gt;-->
<!--&lt;!&ndash;                                </div>&ndash;&gt;-->
<!--&lt;!&ndash;                            </div>&ndash;&gt;-->
<!--&lt;!&ndash;                            {% endif %}&ndash;&gt;-->
<!--&lt;!&ndash;                            {% endfor %}&ndash;&gt;-->
<!--                            <div id="player-box">-->
<!--                            </div>-->
<!--                        </div>-->
<!--                    </div>-->
                    {% endfor %}
                </div>
                <script>
                    // this "lazy" getter for playerImg will either return or create the img
                function playerImg() {
                  let playerImg = document.getElementById('playerimg');
                  if (!playerImg) {
                    playerImg = document.createElement('img');
                    playerImg.id = 'playerimg';
                    document.getElementById('player-box').appendChild(playerImg);
                  }
                  return playerImg;
                }

                // set the source attribute of the playerImg
                function setPlayerImg(src) {
                  playerImg().setAttribute('src', src);
                }

                // get the elements with their common class
                const imgs = document.getElementsByClassName("thumb");

                // for each, add a click handler that calls our src setting function
                for (let i = 0; i < imgs.length; i++) {
                  const el = imgs[i];
                  el.addEventListener('click', () => setPlayerImg(el.src), false);
                }
                </script>
                <!-- Results section ends here -->
            </div>
        </div>
        <figure class="position-absolute bottom-0 left-0 w-100 d-none d-md-block mb-n2">
            <svg class="fill-white" version="1.1" xmlns="http://www.w3.org/2000/svg"
                 xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 1920 43.4"
                 style="enable-background:new 0 0 1920 43.4;" xml:space="preserve">
                  <path d="M0,23.3c0,0,405.1-43.5,697.6,0c316.5,1.5,108.9-2.6,480.4-14.1c0,0,139-12.2,458.7,14.3 c0,0,67.8,19.2,283.3-22.7v35.1H0V23.3z"></path>
               </svg>
        </figure>
    </section>
    <!-- End of Hero section -->
    <section class="section section-md"></section>


</main>

{% include 'includes/footer-about.html' %}

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}{% endblock javascripts %}
